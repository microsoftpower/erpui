<!doctype html>
<html lang="en">
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="jquery.table2excel.js"></script>  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap Cheat Sheet</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
      .center {
        margin: auto;
        width: 60%;
        padding: 10px;
        }  

        .inputbox
        {
            margin: 20px;
        }

        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            padding:10px;
        }

        .my-custom-scrollbar {
            position: relative;
            height: 200px;
            overflow: auto;
            }
        .table-wrapper-scroll-y {
            display: block;
        }

        input[type="checkbox"][readonly] {
            pointer-events: none;
        }
    </style>
  </head>
  <body>
      <script>
          $.ajax({
            type: 'GET',
            crossDomain: true,
            url: 'https://pcberpnet20200627212513.azurewebsites.net/api/data/GetUnique?uniqueLatestFlag=true',
            success: function(jsondata){
                debugger;
                var tableHTML = "<tr style='background-color: blue;color:white'>" +
                                "<th><center>Device ID</center></th>" +
                                "<th><center>Time Stamp (UTC)</center></th>" +
                                "<th><center>In Motion?</center></th>"+
                                "<th><center>Device Orientation</center></th>" +
                                "<th><center>Battery %</center></th>" +
                                "<th><center>Image ID</center></th>" +
                                "</tr>";

                var hiddenTableHTML = "<tr style='background-color: blue;color:white'>" +
                                "<th><center>Device ID</center></th>" +
                                "<th><center>Time Stamp (UTC)</center></th>" +
                                "<th><center>In Motion?</center></th>"+
                                "<th><center>Device Orientation</center></th>" +
                                "<th><center>Battery %</center></th>" +
                                "<th><center>Image ID</center></th>" +
                                "</tr>";

                var table = document.getElementById("table1");
                for(var i=0; i<jsondata.length; i++)
                {
                    var deviceOrientation = "";
                    if (jsondata[i].DeviceOrientation == true)
                        deviceOrientation = "1";
                    else if (jsondata[i].DeviceOrientation == false)
                        deviceOrientation = "0";

                    var motionStatus = "";
                    if (jsondata[i].MotionStatus == true)
                        motionStatus = "<input type='checkbox' checked readonly>";
                    else if (jsondata[i].MotionStatus == false)
                        motionStatus = "<input type='checkbox' readonly>";

                    tableHTML = tableHTML +
                                "<tr>" +
                                "<td><center>" + jsondata[i].DeviceID + "</center></td>" +
                                "<td><center>" + jsondata[i].TimeStamp + "</center></td>" +
                                "<td><center>" + motionStatus + "</center></td>" +
                                "<td><center>" + deviceOrientation + "</center></td>" +
                                "<td><center>" + jsondata[i].Battery + " %</center></td>" +
                                "<td><center>" + jsondata[i].ImageID + "</center></td>" +
                                "</tr>";

                    hiddenTableHTML = hiddenTableHTML +
                                "<tr>" +
                                "<td><center>" + jsondata[i].DeviceID + "</center></td>" +
                                "<td><center>" + jsondata[i].TimeStamp + "</center></td>" +
                                "<td><center>" + jsondata[i].MotionStatus + "</center></td>" +
                                "<td><center>" + deviceOrientation + "</center></td>" +
                                "<td><center>" + jsondata[i].Battery + " %</center></td>" +
                                "<td><center>" + jsondata[i].ImageID + "</center></td>" +
                                "</tr>";
                }

                table.innerHTML = tableHTML;
                document.getElementById("table1hidden").innerHTML = hiddenTableHTML;
            }
        });
      
          $.ajax({
            type: 'GET',
            crossDomain: true,
            url: 'https://pcberpnet20200627212513.azurewebsites.net/api/data/Get',
            success: function(jsondata){
                debugger;
                var tableHTML = "<tr style='background-color: blue;color:white'>" +
                                "<th><center>Device ID</center></th>" +
                                "<th><center>Time Stamp (UTC)</center></th>" +
                                "<th><center>In Motion?</center></th>"+
                                "<th><center>Device Orientation</center></th>" +
                                "<th><center>Battery %</center></th>" +
                                "<th><center>Image ID</center></th>" +
                                "</tr>";

                var hiddenTableHTML = "<tr style='background-color: blue;color:white'>" +
                                "<th><center>Device ID</center></th>" +
                                "<th><center>Time Stamp (UTC)</center></th>" +
                                "<th><center>In Motion?</center></th>"+
                                "<th><center>Device Orientation</center></th>" +
                                "<th><center>Battery %</center></th>" +
                                "<th><center>Image ID</center></th>" +
                                "</tr>";

                var table = document.getElementById("table2");
                for(var i=0; i<jsondata.length; i++)
                {
                    var deviceOrientation = "";
                    if (jsondata[i].DeviceOrientation == true)
                        deviceOrientation = "1";
                    else if (jsondata[i].DeviceOrientation == false)
                        deviceOrientation = "0";

                    var motionStatus = "";
                    if (jsondata[i].MotionStatus == true)
                        motionStatus = "<input type='checkbox' checked readonly>";
                    else if (jsondata[i].MotionStatus == false)
                        motionStatus = "<input type='checkbox' readonly>";

                    tableHTML = tableHTML +
                                "<tr>" +
                                "<td><center>" + jsondata[i].DeviceID + "</center></td>" +
                                "<td><center>" + jsondata[i].TimeStamp + "</center></td>" +
                                "<td><center>" + motionStatus + "</center></td>" +
                                "<td><center>" + deviceOrientation + "</center></td>" +
                                "<td><center>" + jsondata[i].Battery + " %</center></td>" +
                                "<td><center>" + jsondata[i].ImageID + "</center></td>" +
                                "</tr>";

                    hiddenTableHTML = hiddenTableHTML +
                                "<tr>" +
                                "<td><center>" + jsondata[i].DeviceID + "</center></td>" +
                                "<td><center>" + jsondata[i].TimeStamp + "</center></td>" +
                                "<td><center>" + jsondata[i].MotionStatus + "</center></td>" +
                                "<td><center>" + deviceOrientation + "</center></td>" +
                                "<td><center>" + jsondata[i].Battery + " %</center></td>" +
                                "<td><center>" + jsondata[i].ImageID + "</center></td>" +
                                "</tr>";
                }

                table.innerHTML = tableHTML;
                document.getElementById("table2hidden").innerHTML = hiddenTableHTML;
            }
          });
      
      </script>
    <hr style="height:2px;border-width:0;margin-left:50px;margin-right:50px;background-color:blue">
    <h3 style="margin-left:70px;">Send Post Request</h3>  
    <div class="container h-75 d-inline-block w-100 p-3" style="margin-left:70px;margin-right:70px;background-color:#F8C471;width:100%">
        
            <div class="row">
              <div class="col center">
                <div class="form-group" style="margin-left:10px;">
                    <label for="selectdevice">Select Device:</label>
                    <select id="selectdevice">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    </select>
                </div>
              </div>
              <div class="col">
                <input class="inputbox" type="text" id="serverupdatecadence" name="serverupdatecadence" placeholder="Server update Cadence (seconds)" style="width:90%">
                
                <input class="inputbox" type="text" id="awaketrigger" name="awaketrigger" placeholder="Awake trigger (min later to awaken)" style="width:90%">
              </div>
              <div class="col">
                <input class="inputbox" type="text" id="sleeptrigger" name="sleeptrigger" placeholder="Sleep trigger (min to enter Sleep)" style="width:90%">
                <br>
                <input class="inputbox" type="file" id="imagefile" name="imagefile" accept="image/*" placeholder="Image file">
              </div>
            </div>
            <button class="btn btn-secondary float-right" type="button" style="background-color:blue">Submit Post Request</button>
    </div>
    <h3 style="margin-left:70px;">Most Recent Data Point for each Device</h3>  
    <div class="container h-75 d-inline-block w-100 p-3" style="margin-left:70px;margin-right:70px;background-color:#D0CDC8;width:100%">
        <div class="table-wrapper-scroll-y my-custom-scrollbar">
            <table id="table1" class="table table-bordered table-striped mb-0" style="width: 100%;">
            </table>
        </div>
        <table id="table1hidden" hidden>
        </table>
        <br>
        <label id="lastupdate1"></label>
        <button class="float-right" onclick="exportexcel1()">  
            Export to Excel
        </button>  
    </div>
    <h3 style="margin-left:70px;">All Historical Data</h3>  
    <div class="container h-75 d-inline-block w-100 p-3" style="margin-left:70px;margin-right:70px;background-color:#D0CDC8;width:100%">
        <div class="table-wrapper-scroll-y my-custom-scrollbar">
            <table id="table2" class="table table-bordered table-striped mb-0" style="width: 100%;">
            </table>
        </div>
        <table id="table2hidden" hidden>
        </table>
        <br>
        <label id="lastupdate2"></label>
        <button class="float-right" onclick="exportexcel2()">  
            Export to Excel
        </button>  
    </div>

    <script>
        var n =  new Date();
        var y = n.getFullYear();
        var m = n.getMonth() + 1;
        m = m < 10 ? '0' + m : m;
        var d = n.getDate();
        d = d < 10 ? '0' + d : d;
        var hours = n.getHours(); 
        hours = hours < 10 ? '0' + hours : hours;
        var minutes = n.getMinutes(); 
        minutes = minutes < 10 ? '0' + minutes : minutes; 
        var seconds = n.getSeconds(); 
        seconds = seconds < 10 ? '0' + seconds : seconds;
        document.getElementById("lastupdate1").innerHTML ="Last Update: " + hours + ":" + minutes + ":" + seconds + " " + d + "-"+ m + "-"+ y ;
        document.getElementById("lastupdate2").innerHTML ="Last Update: " + hours + ":" + minutes + ":" + seconds + " " + d + "-"+ m + "-"+ y ;
        function exportexcel1(){
            $("#table1hidden").table2excel({
                exclude:".noExl",
                name:"MostRecentDataPointForEachDevice",
                filename:"MostRecentDataPointForEachDevice",
                fileext:".xls" 
            });
        }

        function exportexcel2(){
            $("#table2hidden").table2excel({
                exclude:".noExl",
                name:"AllHistoricalData",
                filename:"AllHistoricalData",
                fileext:".xls" 
            });
        }
    </script>
  </body>